var map;
var markers;
var coords;
var polyline;

function initialize()
{
    // initialize map
    var myOptions =
    {
        center: new google.maps.LatLng(49.7780731,9.9430286),
        zoom: 15,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    markers = new Array();
    polyPoints = new google.maps.MVCArray();
    initPolyline();
    coords = new Array();
}

function initPolyline(){
    var polyOptions = {
        path: polyPoints,
        strokeColor: '#000000',
        strokeOpacity: 1.0,
        strokeWeight: 3};
    polyline = new google.maps.Polyline(polyOptions);

}

function setCenter(){
    map.setCenter(coords[coords.length-1]);
}

function setPath(latitude,longitude){
    setMarker(latitude,longitude);
    setPolyline(latitude,longitude);
    coords.push(new google.maps.LatLng(latitude,longitude));
}

function display(option){
    switch(option){
        case 0:
                fillMap(null);
                polyline.setMap(map);
                break;
        case 1:
                fillMap(map);
                polyline.setMap(map);
                break;
    }
}

function setMarker(latitude,longitude){
    var marker = new google.maps.Marker({
                position: new google.maps.LatLng(latitude, longitude),
                map: map,
             });
        markers.push(marker);
}

function setPolyline(latitude,longitude){
    polyPoints = polyline.getPath();
    polyPoints.push(new google.maps.LatLng(latitude, longitude));
}

function fillMap(option){
    for (var i = 0; i < markers.length; i++){
     markers[i].setMap(option);
    }
}

function clear(){
    fillMap(null);
    markers=0;
    coords.setMap(null);
    coords.length=0;
    polyline.setMap(null);
    polyline.getPath().clear();
    initPolyline();
}

google.maps.event.addDomListener(window, 'load', initialize);
